<script>/*####FONCTION D'INSERTION DE BALISES####*/			function insertTag(startTag, endTag, corpsId, tagType) {		var field  = document.getElementById(corpsId); 		var scroll = field.scrollTop; // On met en mémoire la position du scroll		field.focus(); // On remet le focus sur la zone de texte, suivant les navigateurs, on perd le focus en appelant la fonction. 	 	 /* === Partie 1 : on récupère la sélection === */	if (window.ActiveXObject) {			var textRange = document.selection.createRange();           			var currentSelection = textRange.text;	} else {			var startSelection   = field.value.substring(0, field.selectionStart);			var currentSelection = field.value.substring(field.selectionStart, field.selectionEnd);			var endSelection     = field.value.substring(field.selectionEnd);              	}	 	/* === Partie 2 : on analyse le tagType === */	if (tagType) {			switch (tagType) {					case "lien":							endTag = "</a>";							if (currentSelection) { // Il y a une sélection									if (currentSelection.indexOf("http://") == 0 || currentSelection.indexOf("https://") == 0 || currentSelection.indexOf("ftp://") == 0 || currentSelection.indexOf("www.") == 0) {											// La sélection semble être un lien. On demande alors le libellé											var label = prompt("Quel est le libellé du lien ?") || "";											startTag = "<a class=\"mail\" href=\"" + currentSelection + "\">";											currentSelection = label;									} else {											// La sélection n'est pas un lien, donc c'est le libelle. On demande alors l'URL											var URL = prompt("Quelle est l'url ?");											startTag = "<a class=\"mail\" href=\"" + URL + "\">";									}							} else { // Pas de sélection, donc on demande l'URL et le libelle									var URL = prompt("Quelle est l'url ?") || "";									var label = prompt("Quel est le libellé du lien ?") || "";									startTag = "<a class=\"mail\" href=\"" + URL + "\">";									currentSelection = label;                    							}					break;										case "image":							endTag = "";							if (currentSelection) { // Il y a une sélection								startTag = "<img src=\"" + currentSelection + "\"/>";							}							else { // Pas de sélection, donc on demande l'URL et le libelle									var URL = prompt("Quelle est l'url ?") || "";									startTag = "<img src=\"" + URL + "\"/>";									currentSelection = "";                    							}					break;			}	}	 	/* === Partie 3 : on insère le tout === */	if (window.ActiveXObject) {			textRange.text = startTag + currentSelection + endTag;			textRange.moveStart("character", -endTag.length - currentSelection.length);			textRange.moveEnd("character", -endTag.length);			textRange.select();    	} else {			field.value = startSelection + startTag + currentSelection + endTag + endSelection;			field.focus();			field.setSelectionRange(startSelection.length + startTag.length, startSelection.length + startTag.length + currentSelection.length);	}	field.scrollTop = scroll;     	}/*####FONCTION DE PREVISUALISATION####*/	function preview(corpsId, previewDiv) {		var field = corpsId.value; // Le contenu du textarea est dans la variable field	}</script><?php	$id=0;	$nomserv="";	$corps="";	$logoserv="";	$soustitre="";	if(isset($_GET['id']))	{		mysql_connect('localhost', 'root', '')or die('Erreur SQL !<br />'.mysql_error());		mysql_select_db ('plugit')or die('Erreur SQL !<br />'.mysql_error());				$rq=mysql_query("SELECT COUNT(id) as cpt FROM services WHERE id='".$_GET['id']."'")or die('Erreur SQL !<br />'.mysql_error());		$array=mysql_fetch_array($rq);				if($array['cpt']==1)		{			$rq=mysql_query("SELECT * FROM services WHERE id='".$_GET['id']."'")or die('Erreur SQL !<br />'.mysql_error());			$array=mysql_fetch_array($rq);						$id=$array['id'];			$nomserv=$array['titre'];			$corps=$array['corps'];			$logoserv=$array['image'];			$soustitre=$array['subtitre'];		}		else		{			echo '<center><font color=red>Erreur référence introuvable</font></center><br/>';		}				mysql_close();	}		if($id!=0)	{		echo '<h2>Modification d\'un service</h2>			<br/><center>Tout champ vide ne sera pas modifié</center>';		$require = "";	}	else	{		echo '<h2>Ajout d\'un service</h2>';		$require = "required";	}	?><form method="post" enctype="multipart/form-data" action="#">	<table border="0" cellspacing="20" cellpadding="5" style="margin:auto;">							<tr>				<td><label for="nomserv"><b>Nom du service <span class="red">*</span></b></label></td>				<td><input size="50" type="text" name="nomserv" id="nomserv" value="<?php echo $nomserv; ?>" <?php echo $require; ?> /></td>			</tr>						<tr>				<td><label for="logoserv"><b>Logo du service <span class="red">*</span></b></label></td>				<td><input size="50" type="file" name="logoserv" id="logoserv" value="<?php echo $logoserv; ?>" <?php echo $require; ?>/></td>			</tr>						<tr>				<td><label for="soustitre"><b>Sous-titre <span class="red">*</span></b></label></td>				<td><input size="50" type="text" name="soustitre" id="soustitre" value="<?php echo $soustitre; ?>" <?php echo $require; ?>/></td>			</tr>						<tr>				<td colspan="2">					<form action="" method="post">					<div>						<p>							<b>Description du service <span class="red">*</span></b>							<br/>							<input type="button" value="G" onclick="insertTag('<b>','</b>','corps');" />							<input type="button" value="I" onclick="insertTag('<i>','</i>','corps');" />							<input type="button" value="S" onclick="insertTag('<u>','</u>','corps');" />							<input type="button" value="Lien" onclick="insertTag('','','corps','lien');" />							<input type="button" value="Image" onclick="insertTag('','','corps','image');" />							<input type="button" value="Titre" onclick="insertTag('<span class=&quot titre&quot>','</span>','corps');" />							<img src="images/fleche.png" alt="fleche" onclick="insertTag('<img src=&quot images/fleche.png&quot/>','','corps');" />						</p>						<p>							<input name="previsualisation" type="checkbox" id="previsualisation" value="previsualisation" />							<label for="previsualisation">Prévisualisation automatique</label>						</p>					</div>										<textarea onkeyup="preview(this, 'previewDiv');" onselect="preview(this, 'previewDiv');" id="corps" cols="65" rows="25"></textarea>					 					<div id="previewDiv"></div>				 					<p>						<input type="button" value="Visualiser" onclick="view('corps','viewDiv');" />					</p>				 					<div id="viewDiv"></div>				</form>				</td>			</tr>						<tr>				<td style="text-align:right;"><input type="submit" name="envoyer" value="Envoyer" /></td>			</tr>			</table></form>	