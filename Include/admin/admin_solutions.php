<script>/*####FONCTION D'INSERTION DE BALISES####*/			function insertTag(startTag, endTag, corpsId, tagType) {		var field  = document.getElementById(corpsId); 		var scroll = field.scrollTop; // On met en mémoire la position du scroll		field.focus(); // On remet le focus sur la zone de texte, suivant les navigateurs, on perd le focus en appelant la fonction. 	 	 /* === Partie 1 : on récupère la sélection === */	if (window.ActiveXObject) {			var textRange = document.selection.createRange();           			var currentSelection = textRange.text;	} else {			var startSelection   = field.value.substring(0, field.selectionStart);			var currentSelection = field.value.substring(field.selectionStart, field.selectionEnd);			var endSelection     = field.value.substring(field.selectionEnd);              	}	 	/* === Partie 2 : on analyse le tagType === */	if (tagType) {			switch (tagType) {					case "lien":							endTag = "</a>";							if (currentSelection) { // Il y a une sélection									if (currentSelection.indexOf("http://") == 0 || currentSelection.indexOf("https://") == 0 || currentSelection.indexOf("ftp://") == 0 || currentSelection.indexOf("www.") == 0) {											// La sélection semble être un lien. On demande alors le libellé											var label = prompt("Quel est le libellé du lien ?") || "";											startTag = "<a class=\"mail\" href=\"" + currentSelection + "\">";											currentSelection = label;									} else {											// La sélection n'est pas un lien, donc c'est le libelle. On demande alors l'URL											var URL = prompt("Quelle est l'url ?");											startTag = "<a class=\"mail\" href=\"" + URL + "\">";									}							} else { // Pas de sélection, donc on demande l'URL et le libelle									var URL = prompt("Quelle est l'url ?") || "";									var label = prompt("Quel est le libellé du lien ?") || "";									startTag = "<a class=\"mail\" href=\"" + URL + "\">";									currentSelection = label;                    							}					break;										case "image":							endTag = "";							if (currentSelection) { // Il y a une sélection								startTag = "<img src=\"" + currentSelection + "\"/>";							}							else { // Pas de sélection, donc on demande l'URL et le libelle									var URL = prompt("Quelle est le chemin de l'image ?\n (si elle est en local, exemple : images/nom_de_l_image.png)") || "";									startTag = "<img src=\"" + URL + "\"/>";									currentSelection = "";                    							}					break;			}	}	 	/* === Partie 3 : on insère le tout === */	if (window.ActiveXObject) {			textRange.text = startTag + currentSelection + endTag;			textRange.moveStart("character", -endTag.length - currentSelection.length);			textRange.moveEnd("character", -endTag.length);			textRange.select();    	} else {			field.value = startSelection + startTag + currentSelection + endTag + endSelection;			field.focus();			field.setSelectionRange(startSelection.length + startTag.length, startSelection.length + startTag.length + currentSelection.length);	}	field.scrollTop = scroll;     	}/*####FONCTION PERMETTANT DE FAIRE DES REQUETES HTTP POUR RECUPERER DONNEES AU FORMAT XML####*/	function getXMLHttpRequest() {    var xhr = null;         if (window.XMLHttpRequest || window.ActiveXObject) {        if (window.ActiveXObject) {            try {                xhr = new ActiveXObject("Msxml2.XMLHTTP");            } catch(e) {                xhr = new ActiveXObject("Microsoft.XMLHTTP");            }        } else {            xhr = new XMLHttpRequest();        }    } else {        alert("Votre navigateur ne supporte pas l'objet XMLHTTPRequest...");        return null;    }         return xhr;}/*####FONCTION DE VISUALISATION####*/function view(textareaId, viewDiv){    var content = encodeURIComponent(document.getElementById(textareaId).value);    var xhr = getXMLHttpRequest();         if (xhr && xhr.readyState != 0) {        xhr.abort();        delete xhr;    }         xhr.onreadystatechange = function() {        if (xhr.readyState == 4 && xhr.status == 200){            document.getElementById(viewDiv).innerHTML = xhr.responseText;        } else if (xhr.readyState == 3){            document.getElementById(viewDiv).innerHTML = "<div style=\"text-align: center;\">Chargement en cours...</div>";        }    }         xhr.open("POST", "include/admin/view.php", true);    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");    xhr.send("string=" + content);}</script><?php	$id=0;	$nomsolu="";	$corps="";	$logosolu="";	$grandeimg="";	$desc="";		if(isset($_POST) and !empty($_POST))	{		$id= (isset($_GET['id'])) ? $_GET['id']:0;		$nomsolu=$_POST['nomsolu'];		$dsec=$_POST['desc'];		$corps=$_POST['corps'];	}	if(isset($_GET['id']))	{		mysql_connect('localhost', 'root', '')or die('Erreur SQL !<br />'.mysql_error());		mysql_select_db ('plugit')or die('Erreur SQL !<br />'.mysql_error());				$rq=mysql_query("SELECT COUNT(id) as cpt FROM solutions WHERE id='".$_GET['id']."'")or die('Erreur SQL !<br />'.mysql_error());		$array=mysql_fetch_array($rq);				if($array['cpt']==1)		{			$rq=mysql_query("SELECT * FROM solutions WHERE id='".$_GET['id']."'")or die('Erreur SQL !<br />'.mysql_error());			$array=mysql_fetch_array($rq);						$id=$array['id'];			$nomsolu=$array['titre'];			$corps=$array['corps'];			$logosolu=$array['image_sol'];			$desc=$array['description'];			$grandeimg=$array['image_car'];		}		else		{			echo '<center><font color=red>Erreur solutions introuvable</font></center><br/>';		}				mysql_close();	}		if($id!=0)	{		echo '<h2>Modification d\'une solution</h2>			<br/><center>Tout champ vide ne sera pas modifié</center>';		$require = "";		$type = "modif&id=".$id;	}	else	{		echo '<h2>Ajout d\'une solution</h2>';		$require = "required";		$type = "create";	}	?><form method="post" enctype="multipart/form-data" action="traitement/trt_solutions.php?mode=<?php echo $type; ?>">	<table border="0" cellspacing="20" cellpadding="5" style="margin:auto;">							<tr>				<td><label for="nomsolu"><b>Nom de la solution <span class="red">*</span></b></label></td>				<td><input size="50" type="text" name="nomsolu" id="nomsolu" value="<?php echo $nomsolu; ?>" <?php echo $require; ?> /></td>			</tr>						<tr>				<td><label for="logosolu"><b>Logo de la solution <span class="red">*</span></b></label></td>				<td><input size="50" type="file" name="logosolu" id="logosolu" value="<?php echo $logosolu; ?>" <?php echo $require; ?>/></td>			</tr>						<tr>				<td><label for="grandeimg"><b>Grande image pour l'accueil <span class="red">*</span></b></label></td>				<td><input size="50" type="file" name="grandeimg" id="grandeimg" value="<?php echo $grandeimg; ?>" <?php echo $require; ?>/></td>			</tr>						<tr>				<td><label for="desc"><b>Résumé de la solution <span class="red">*</span></b></label></td>				<td><textarea name="desc" id="desc" rows="5" cols="40" style="resize:none" <?php echo $require; ?>/><?php echo $desc; ?></textarea></td>			</tr>						<tr>				<td colspan="2">					<div>						<p>							<b>Description du service <span class="red">*</span></b>							<br/>							<input type="button" value="G" onclick="insertTag('<b>','</b>','corps');" />							<input type="button" value="I" onclick="insertTag('<i>','</i>','corps');" />							<input type="button" value="S" onclick="insertTag('<u>','</u>','corps');" />							<input type="button" value="Lien" onclick="insertTag('','','corps','lien');" />							<input type="button" value="Image" onclick="insertTag('','','corps','image');" />							<input type="button" value="Titre" onclick="insertTag('<span class=&quot titre&quot>','</span>','corps');" />							<img src="images/fleche.png" alt="fleche" onclick="insertTag('<img src=&quot images/fleche.png&quot/>','','corps');" />						</p>					</div>										<textarea id="corps" name="corps" cols="65" rows="25"><?php echo $corps; ?></textarea>					 					<div id="previewDiv"></div>				 					<p>						<input type="button" value="Visualiser" onclick="view('corps','viewDiv');" />					</p>				 					<div id="viewDiv"></div>				</td>			</tr>						<tr>				<td style="text-align:right;"><input type="submit" name="envoyer" value="Envoyer" /></td>			</tr>			</table></form>	